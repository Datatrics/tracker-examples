<script>
	var ecommerce = {{datatrics_ecommerce}};
	if (ecommerce) {
		if (ecommerce.impressions) {
			for (var j = 0; j < ecommerce.impressions.length; j++) {
				var impression = ecommerce.impressions[j];
				_paq.push(['setEcommerceView',
					impression.id,
					impression.name,
					impression.price
				]);
				_paq.push(['trackPageView']);
			}
		}
		if(ecommerce.add){
			var total = 0;
			for (var k = 0; k < ecommerce.add.products.length; k++) {
				var product = ecommerce.add.products[k];
				total += product.price;
				_paq.push(['addEcommerceItem',
					product.id,
					product.name,
					product.category,
					product.price,
					product.quantity
				]);
			}
			_paq.push(['trackEcommerceCartUpdate', total]);
			_paq.push(['trackPageView']);
		}
		if(ecommerce.detail){
			for (var k = 0; k < ecommerce.detail.products.length; k++) {
				var product = ecommerce.detail.products[k];
				_paq.push(['setEcommerceView',
					product.id,
					product.name,
					product.price
				]);
				_paq.push(['trackPageView']);
			}
		}
		if(ecommerce.checkout){
			var total = 0;
			for (var k = 0; k < ecommerce.checkout.products.length; k++) {
				var product = ecommerce.checkout.products[k];
				total += product.price;
				_paq.push(['addEcommerceItem',
					product.id,
					product.name,
					product.category,
					product.price,
					product.quantity
				]);
			}
			_paq.push(['trackEcommerceCartUpdate', total]);
			_paq.push(['trackPageView']);
		}
		if(ecommerce.purchase){
			var total = 0;
			for (var k = 0; k < ecommerce.purchase.products.length; k++) {
				var product = ecommerce.purchase.products[k];
				total += product.price;
				_paq.push(['addEcommerceItem',
					product.id,
					product.name,
					product.category,
					product.price,
					product.quantity
				]);
			}
			_paq.push(['trackEcommerceOrder',
				ecommerce.purchase.actionField.id,
				ecommerce.purchase.actionField.revenue,
				ecommerce.purchase.actionField.revenue-ecommerce.purchase.actionField.tax,
				ecommerce.purchase.actionField.tax,
				ecommerce.purchase.actionField.shipping
				false
			]);
			_paq.push(['trackPageView']);
		}
	}
</script>
